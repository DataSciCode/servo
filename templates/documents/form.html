{% load i18n %}
<form method="post" action="/document/save" rel="attachments">
  {% csrf_token %}
  {% if id %}
    <input type="hidden" name="id" value="{{ id }}"/>
  {% endif %}
	<label>{% trans "Nimi" %}:</label>
	<input type="text" name="name" value="{{ name }}"/>
	<br/>
	<label>{% trans "Kuvaus" %}:</label>
	<textarea name="description">{{ description }}</textarea>
	<br/>
	<label>{% trans "Tagit" %}:</label>
{% for t in  product.tags %}
  <input type="text" name="tags" style="width:80px" class="autocomplete tag" value="{{ t }}"/>
{% endfor %}
	<input type="text" id="newTag" class="autocomplete" style="width:80px"/>
	<br/>
	<label>{% trans "Tiedosto" %}:</label>
	<input type="file" name="incoming" id="fileupload"/>
</form>
<script type="text/javascript">
	$("#fileupload").fileupload({url: "/document/save"});
	$(".autocomplete").autocomplete({source: "/tag/index/document"});
	$(".autocomplete").keydown(function(e) {
    if(e.keyCode == 13) {
      $.post("/tag/save/document", { tag: $(this).val() });
      $('<input type="text" name="tags" class="autocomplete tag" style="width:76px"/>')
        .insertBefore($("#newTag")).val($(this).val());
      $(this).val("");
    }
 	});

  $(".tag").keydown(function(e) {
    if($(this).val().length < 1) {
      $(this).remove();
      e.preventDefault();
    }
  });
</script>
