{% extends request.is_ajax|yesno:"empty.html,default.html" %}
{% load i18n %}

{% block title %}Tuotteet{% endblock title %}

{% block toolbar %}

<ul>
    <li><a href="/products/create" class="popup">{% trans "Uusi tuote" %}</a></li>
</ul>

{% endblock toolbar %}

{% block secondary %}

<li><a href="javascript:;" class="search popup">&nbsp;</a>
    <ul>
        <li>
        <table>
{% for tag in tags %}
          <tr>
            <td style="width:25px">
              <input type="checkbox" class="filterProducts" value="{{ tag.title }}"/>
            </td>
            <td style="width:80px">{{ tag.title }}</td>
          </tr>
{% endfor %}
        </table>
      </li>
    </ul>
  </li>
  <li><a href="/store/order_products/" class="purchase popup buy">&nbsp;</a></li>
  <li><a href="/store/sell_products/" class="sell popup sell">&nbsp;</a></li>

{% endblock secondary %}

{% block content %}

<div class="small_block">
    <div class="listView" style="top:0px;bottom:0px;left:0px;right:0px;position:absolute">
        {% for i in data %}
        <div class="list-view-item" data-url="/products/{{ i.id }}/edit/" class="{% cycle 'odd' 'even' %}">
            <div class="first-row code">
                <span class="wrapper">{{ i.code }}</span>
            </div>
            <div class="second-row title">
                {{ i.title }}
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script type="text/javascript" charset="utf-8">
    $(".selected_product").click(function() {
        url = $(".buy").attr("href");
        url = url+$(this).val()+";";
        $(".buy").attr("href", url);
    });

    $(".selected_product").click(function() {
        url = $(".sell").attr("href");
        url = url + $(this).val()+";";
        $(".sell").attr("href", url);
    });

    $("#search_query").keydown(function(e) {
        var rex = new RegExp($(this).val(), 'i');
        $('#products tbody tr').hide();
        $('#products tbody tr').filter(function() {
            return rex.test($(this).text());
        }).show();
    });

    $('#searchbar .dropdown').click(function() {
        $(this).toggleClass('enabled');
    });
    $('#searchbar .dropdown ul li a').click(function() {
        console.log('clicked!')
        $(this).parent('.dropdown').val($(this).text());
    });
</script>

{% endblock  %}
